import hashlib

users_database = {
    '77514073ef5118a0ea095939271fddb52dac360f1bb8a557e7e81cd0438723e8': '53f304f7398a5ee2e4f70bda3b65e2a66629908876a7c99a91efc818a83cc6a38416f9807c0794a31a5deb8f262e6d98c78f61c7c2914ae8e9c347b416f9929c',
    '1fa059fc125bf7644f02c9c50335e3ed4488ccde1fb5d8b384e72ad48175cca2': '46541e6fd98df448c515ce82213453873302900ef5f1c81657477ac1f5d952d6d88b661b8e9ca63af76163bb89d25d975f21b57e30f99bd6a6102807a6c9bf5a',
    'a1ed2680e5e97f40e2b2173863d99d9cc847993c9395b73a87e4d83a8b46ca0b': '46541e6fd98df448c515ce82213453873302900ef5f1c81657477ac1f5d952d6d88b661b8e9ca63af76163bb89d25d975f21b57e30f99bd6a6102807a6c9bf5a',
    'd96590715ae89273331bc5e605cdc13da9b1592f9950da4a387576bd24c323c5': '46541e6fd98df448c515ce82213453873302900ef5f1c81657477ac1f5d952d6d88b661b8e9ca63af76163bb89d25d975f21b57e30f99bd6a6102807a6c9bf5a',
    '2bf6bc48bd2ae6ecdf9f6db0c0dc3a26f08d6bd714ba62893ca1a4a414271cae': '53f304f7398a5ee2e4f70bda3b65e2a66629908876a7c99a91efc818a83cc6a38416f9807c0794a31a5deb8f262e6d98c78f61c7c2914ae8e9c347b416f9929c',
}

def authenticate(server, user, password):
    assert server in ['vulnerable', 'secured']
    salted = user.strip() + '51cQxlJaQqv3'
    user_key = hashlib.sha256(salted.encode('utf-8')).hexdigest()
    if user_key in users_database:
        if users_database[user_key] == hashlib.sha512(password.encode('utf-8')).hexdigest():
            return 'SUCCESS'
    if server == 'secured':
        dummy = hashlib.sha512(password.encode('utf-8'))
    return 'FAIL'
